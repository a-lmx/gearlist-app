<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <ul class="nav navbar-nav navbar-right">
      <% if session[:user_id] %>
        <li>
          <p class="navbar-text">Welcome, <%= session[:user_id] %>.</p>
        </li>
        <li>
          <%= link_to "Log out", "/logout", method: 'delete', class: "btn btn-default", onclick: "signOut();" %>  
        </li>
      <% end %>
    </ul>

    <script>
      function signOut() {
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
          console.log('User signed out.');
          auth2.disconnect();
          signOutSessions();
        });
      };

      function signOutSessions() {
        var url = '/logout';
        $.ajax({
          url: url,
          type: 'DELETE',
          success: function(data, textStatus, jqHXR) {
            window.location.replace("/login");
          }
        });
      };
    </script>
  </div>
</nav>
